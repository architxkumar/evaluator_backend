rdering Cloudy,Sprinkler,Rain,Wet Grass :
1. Samplefrom P(Cloudy) (cid:16)0.5,0.5(cid:17),valueistrue.
2. Samplefrom P(Sprinkler Cloudy true) (cid:16)0.1,0.9(cid:17),valueisfalse.
3. Samplefrom P(Rain Cloudy true) (cid:16)0.8,0.2(cid:17),valueistrue.
4. Samplefrom P(Wet Grass Sprinkler false,Rain true) (cid:16)0.9,0.1(cid:17),valueistrue.
Inthiscase, PRIOR-SAMPLE returnstheevent true,false,true,true .
Section14.5. Approximate Inferencein Bayesian Networks 531
function PRIOR-SAMPLE(bn)returnsaneventsampledfromthepriorspecifiedbybn
inputs:bn,a Bayesiannetworkspecifyingjointdistribution P(X
1
,...,Xn)
x aneventwithnelements
foreachvariable Xiin X
1
,...,Xndo
x i arandomsamplefrom P(Xi parents(Xi))
returnx
Figure14.13 Asamplingalgorithmthatgenerateseventsfroma Bayesiannetwork.Each
variableissampledaccordingtotheconditionaldistributiongiventhevaluesalreadysampled
forthevariable sparents.
Itiseasytoseethat PRIOR-SAMPLE generatessamplesfromthepriorjointdistribution
specifiedbythenetwork. First,let S (x ,...,x )betheprobability thataspecificeventis
PS 1 n
generated bythe PRIOR-SAMPLE algorithm. Justlooking atthesamplingprocess, wehave
(cid:25)n
S (x ...x ) P(x parents(X ))
PS 1 n i i
i 1
because each sampling step depends only on the parent values. This expression should look
familiar, because itisalsothe probability ofthe eventaccording tothe Bayesian net s repre-
sentation ofthejointdistribution, asstatedin Equation(14.2). Thatis,wehave
S (x ...x ) P(x ...x ).
PS 1 n 1 n
Thissimplefactmakesiteasytoanswerquestions byusingsamples.
In any sampling algorithm, the answers are computed by counting the actual samples
generated. Suppose there are N total samples, and let N (x ,...,x ) be the number of
PS 1 n
timesthespecificeventx ,...,x occurs inthesetofsamples. Weexpect thisnumber, asa
1 n
fraction of the total, to converge in the limit to its expected value according to the sampling
probability:
N (x ,...,x )
PS 1 n
lim S (x ,...,x ) P(x ,...,x ). (14.5)
PS 1 n 1 n
N N
For exa